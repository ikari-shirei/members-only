extends layout

block content
    div.container
        if currentUser
            div.profile-container
            div.profile-top
                div.avatar
                    img(src=`/images/${currentUser.avatar}.svg`)
                |
                div.profile-top-right
                    h1.username= currentUser.username
                    h5.email= currentUser.email
                    if currentUser.isMember && !currentUser.isAdmin
                        h5.email Member
                    if currentUser.isAdmin
                        h5.email Admin
            form(action='/logout' method='POST')
                button( type="submit" id="logout" ) LOGOUT
            form(action='/delete-account' method='POST')
                button( type="submit" id="delete") Delete account
            if !currentUser.isMember
                form(method="POST", action='/code' ) 
                    div.form-div
                        label(for="code") Enter membership code:
                        input(type="text" id="code", name="code" required="true")
                    button(type="submit") Submit
                    if errors 
                        ul
                            for error in errors
                                li= error.msg 
            if currentUser.isMember
                h2 Add post
                form(method="POST", action='/message' ) 
                    div.form-div
                        label(for="title") Title:
                        input(type="text" id="title", name="title" required="true")
                    div.form-div
                        label(for="text") Message:
                        input(type="text" id="text", name="text" required="true")
                    button(type="submit") Submit
                    if errorsPost
                        ul
                            for error in errorsPost
                                li= error.msg             

            div.posts
                h2 Your posts
                if currentUser && currentUser.isMember
                    div.messages.container
                        if messages
                            for message in messages
                                div.message-container
                                    div
                                        h1.title= message.title 
                                        p.text= message.text
                                    div.message-detail-container
                                        div.avatar-username-container
                                            div.avatar-message
                                                a(href=message.user.url)
                                                    p.username-message= message.user.username
                                                a(href=message.user.url)
                                                    img(src=`/images/${message.user.avatar}.svg`)
                                        div.timestamp-container
                                            p.timestamp-message= message.readableDate
                                            
                                        form(method="POST", action='/delete-message')
                                            input(type="password" id="targetMessage", name="targetMessage" value=`${message._id}` style="display: none") 
                                            input(type="password" id="targetUser", name="targetUser" value=`${message.user._id}` style="display: none") 
                                            button Delete



